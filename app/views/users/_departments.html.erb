<%if controller.action_name == "edit" && check.present?%>
  <%= f.label :Affiliation %><br />
  <%department = Department.where(:id => @user.department_id).map{|u| [u.name, u.id]}%>
  <%= f.select :department_id, department, {:prompt=> "select a department"}%>
<%else%>
  <%= label_tag :Affiliation %><br />
  <% unless departments.blank? %>
    <%if current_user.present? && (current_user.department_id.present?)%>
      <%= "aaaaaaaaaaaaaaaaaa" %>
      <%= select_tag "user[department_id]", options_for_select(departments.map{|d| [d.name, d.id]},current_user.department_id) %>
    <%else%>
      <%#= "aaaaaaaaaaaaaaaaaa" %>
      <%= select_tag "user[department_id]", options_for_select(departments.map{|d| [d.name, d.id]},:prompt=> "Select an Affiliation") %>
    <%end%>
  <%else%>
    <%#= "aaaaaaaaaaaaaaaaaa" %>
    <%= select_tag :department_id, "", :prompt=> "Select an Affiliation"%>
  <%end%>

<%end%>